# The Paper  
## Introductio
传统的蛋白质工程方法通过对自然蛋白质序列进行迭代突变和选择，以识别具有期望的功能和结构特性的蛋白质。相比之下，理性或从零开始的蛋白质设计方法旨在提高创造具有期望特性的新蛋白质的效率和精确度。基于结构的从零开始设计方法利用基于生物物理原理的模拟，而共演化方法则从进化序列数据构建统计模型，以指定具有期望功能或稳定性的新序列。结构方法和共演化方法都有其局限性。结构方法依赖于稀缺的实验结构数据和难以处理或无法处理的生物物理模拟。共演化统计模型定制于特定的蛋白质家族，经常依赖于多序列比对，并且在定义的多序列比对之外的空间操作不佳。最近，深度神经网络作为蛋白质科学和工程的生成模型和判别模型显示出了前景。它们学习复杂表示的能力对于有效利用呈指数级增长的多样化且相对未注释的蛋白质数据源至关重要——包含数以百万计原始未比对蛋白质序列的公共数据库。  

受到基于深度学习的自然语言模型成功的启发，这些模型经过大量文本语料的训练，能够生成涵盖多种主题和情感的逼真文本，我们开发了ProGen，这是一个基于数百万条原始蛋白质序列训练的蛋白质语言模型，它能够生成跨多个家族和功能的人造蛋白质。虽然之前的工作已经表明，受自然语言启发的蛋白质统计表示对于蛋白质信息学任务（如稳定性预测、远源同源性检测和二级结构预测）是有用的，我们展示了如何采用基于深度学习的最新语言建模进展，从头开始生成功能与自然蛋白质一样好的人造蛋白质序列。  

ProGen通过迭代优化来学习预测在一条原始序列中，给定前面的氨基酸后下一个氨基酸的概率，而不需要显式的结构信息或成对的共演化假设。通过这种无监督方式从一个大型、多样化的蛋白质序列数据库（补充表1）训练，ProGen学习了一个通用的、领域独立的蛋白质表示，这种表示包含了局部和全局结构模式，类似于自然语言模型学习语义和语法规则。训练完成后，ProGen可以被提示从头开始为任何蛋白质家族生成全长蛋白质序列，这些序列与自然蛋白质有不同程度的相似性。在常见情况下，如果某个蛋白质家族的一些序列数据是可用的，我们可以使用预训练语言模型的微调技术，用家族特定的序列来进一步提高ProGen捕获与蛋白质家族对应的局部序列邻域分布的能力。  

ProGen是一个拥有12亿参数的神经网络，使用一个公开可用的包含2.8亿蛋白质序列的数据集进行训练。ProGen的一个关键组成部分是条件生成，即，通过控制标签（例如，蛋白质家族：Pfam ID PF16754, Pesticin）控制序列生成，这些标签作为输入提供给语言模型。在自然语言的情况下，这些控制标签可能是风格、主题、日期和其他实体。对于蛋白质而言，控制标签是蛋白质家族、生物过程和分子功能等属性，这些属性在公共蛋白质数据库的大量序列中是可用的。  
![figure 1](fig1-1.png)  
图1 | 利用条件语言建模的人造蛋白质生成。a，条件语言模型是可以生成语义上和语法上正确的、新颖且多样化的自然语言文本的深度神经网络，通过输入控制标签来驾驭文本的风格、主题和其他实体。b，c，类似于自然语言模型，我们开发了ProGen，一个条件蛋白质语言模型（b），它根据输入控制标签（c）生成跨蛋白质家族的多样化人造蛋白质序列。d，ProGen使用一个大型的、普遍的蛋白质序列数据集进行训练，该数据集包含来自数千个家族的2.8亿个自然进化的蛋白质，其中五个多样化的溶菌酶家族在本研究中被实验性地表征。e，ProGen是一个基于变压器架构的12亿参数神经网络，该架构使用自注意力机制来建模全面的残基间相互作用。ProGen通过在普遍蛋白质序列数据集上最小化下一个氨基酸预测问题的损失来训练生成人造序列。 

## Results
我们通过在五个不同的溶菌酶家族的蛋白质上测试其生成物，实验性地评估了ProGen生成功能性人造氨基酸序列的能力（补充表2）。这些蛋白质家族包含大量的序列多样性（补充表3），平均序列长度在各个家族之间变化，从84到167不等。这些序列还显示出大的结构多样性和多种结构折叠（补充图2）。作为一个整体，对于一个在生成时不受限于已知功能野生型附近的局部序列邻域，并且也没有提供结构先验的模型来说，这代表了一个挑战性的设计空间。我们从Pfam和UniprotKB源收集了这五个家族的55,948个序列，以获得积极的对照，并用于微调ProGen。  

使用精选的溶菌酶数据集对ProGen进行微调后，我们通过为每个家族提供Pfam ID作为控制标签，使用ProGen生成了一百万条人造序列。我们的人造溶菌酶跨越了自然溶菌酶的序列景观（图2a），涵盖了包含多种蛋白质折叠、活性位点架构和酶促机制的五个家族。由于我们的模型可以在毫秒内生成全长人造序列，因此可以创建一个大型数据库，以扩展超越自然库的合理序列多样性（补充表3）。尽管从序列身份计算的角度看，人造序列可能与自然序列有所偏离（图2b和补充图3），但在形成每个家族内的自然和人造蛋白质的单独多序列比对时，它们显示出类似的残基位置熵。这表明模型捕获了进化保守模式，而无需训练显式的比对信息，如使用波特模型，正如在直接耦合分析中实现的那样。 

![figure 2](fig1-2)

为了实验性地评估ProGen在从自然蛋白质序列发散的范围内的表现，我们基于生成质量和与自然序列的多样性选择了一百个序列，通过衡量与我们训练数据集中的任何蛋白质的最高命中身份（“最大ID”）来测量，该数据集包含2.8亿蛋白质，主要由UniParc21组成（补充图4）。我们选择的蛋白质包括100个人造序列（补充表2），每个蛋白质家族至少有8个蛋白质。人造蛋白质的平均序列长度在各个家族之间变化，从93到179不等，与我们从Pfam精选数据集中的自然溶菌酶可比。人造蛋白质包括在溶菌酶家族特定比对中从未在对齐位置观察到的特定氨基酸和成对相互作用（补充表4和5）。我们还从55,948个精选的溶菌酶序列中选择了一个正面对照组。我们使用MMseqs2对自然序列进行了聚类，并从五个家族中的每一个家族大约选择了20个聚类代表性序列。  









